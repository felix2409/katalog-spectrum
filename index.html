<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spectrum Mulyosari ‚Ä¢ Katalog Harga (Laser)</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#101827;
      --card:#0f1a2b;
      --text:#e6edf6;
      --muted:#a8b3c7;
      --accent:#ffd54a;
      --accent2:#56c8ff;
      --ok:#42d39b;
      --danger:#ff5c7a;
      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--font); color:var(--text);
      background:
        radial-gradient(900px 400px at 15% 0%, rgba(255,213,74,.18), transparent 70%),
        radial-gradient(700px 500px at 85% 0%, rgba(86,200,255,.16), transparent 65%),
        radial-gradient(900px 700px at 50% 110%, rgba(66,211,155,.10), transparent 65%),
        var(--bg);
      min-height:100vh;
    }
    .wrap{max-width:1180px; margin:0 auto; padding:18px 18px 26px;}
    header{display:flex; gap:14px; align-items:flex-start; justify-content:space-between; margin-bottom:14px;}
    .brand{display:flex; gap:12px; align-items:flex-start;}
    .logoImg{
      width:220px; max-width:46vw; height:auto;
      border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      padding:10px;
    }
    .hTitle{margin:0; font-size:18px; font-weight:900; letter-spacing:.2px}
    .subtitle{color:var(--muted); font-size:13px; margin-top:6px; line-height:1.55}
    .subtitle b{color:var(--text)}
    .topActions{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;}

    .btn{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      transition:.15s transform, .15s background, .15s border;
      display:inline-flex; gap:8px; align-items:center;
      user-select:none;
      box-shadow: 0 8px 20px rgba(0,0,0,.18);
      font-size:13px;
      white-space:nowrap;
      text-decoration:none;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.16)}
    .btn.primary{background: linear-gradient(135deg, rgba(255,213,74,.18), rgba(86,200,255,.12)); border-color: rgba(255,213,74,.35);}
    .btn.ok{border-color: rgba(66,211,155,.40)}
    .btn.danger{border-color: rgba(255,92,122,.35)}

    .pill{
      font-size:12px; color:var(--muted);
      border:1px solid rgba(255,255,255,.10);
      border-radius:999px;
      padding:6px 10px;
      background: rgba(255,255,255,.04);
      display:inline-flex; gap:8px; align-items:center;
    }
    .mono{font-family:var(--mono)}

    .panel{
      background: rgba(16,24,39,.78);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 22px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }

    .tabsWrap{padding:12px 14px 10px; border-bottom:1px solid rgba(255,255,255,.08);}
    .tabs{display:flex; gap:8px; overflow:auto; padding-bottom:4px; scrollbar-width: thin;}
    .tab{
      flex:0 0 auto;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      cursor:pointer;
      font-size:12px;
      color:var(--text);
      user-select:none;
      white-space:nowrap;
    }
    .tab.active{border-color: rgba(255,213,74,.35); background: rgba(255,213,74,.10);}

    .toolbar{
      padding:12px 14px 14px;
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      align-items:end;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .field label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px 2px;}
    .input{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(11,15,23,.55);
      color:var(--text);
      padding:11px 12px;
      outline:none;
      font-size:13px;
    }
    .input::placeholder{color: rgba(168,179,199,.65)}
    .content{padding:14px;}

    .card{
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(15,26,43,.92), rgba(15,26,43,.72));
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(350px 120px at 20% 0%, rgba(255,213,74,.18), transparent 70%),
        radial-gradient(300px 150px at 90% 0%, rgba(86,200,255,.14), transparent 65%);
      pointer-events:none;
      opacity:.65;
    }
    .cardInner{position:relative; padding:14px;}

    .badge{
      font-size:11px;
      padding:6px 9px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: var(--text);
      white-space:nowrap;
    }
    .badge.accent{border-color: rgba(255,213,74,.35)}
    .badge.blue{border-color: rgba(86,200,255,.35)}
    .badge.ok{border-color: rgba(66,211,155,.35)}
    .tiny{font-size:11px; color:rgba(168,179,199,.78)}

    .itemList{display:flex; flex-direction:column; gap:10px;}
    .itemCard{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(11,15,23,.32);
    }

    .thumb{
      width:64px; height:64px;
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.22);
      background: rgba(255,255,255,.05);
      overflow:hidden;
      display:flex; align-items:center; justify-content:center;
      flex:0 0 auto;
    }
    .thumb img{width:100%; height:100%; object-fit:cover; display:block;}
    .thumb .ph{
      font-weight:900;
      color: rgba(255,255,255,.75);
      font-size:13px;
      letter-spacing:.5px;
      text-align:center;
      padding:6px;
      line-height:1.1;
    }

    .itemMain{min-width:0;}
    .itemName{font-weight:800; font-size:13px; line-height:1.25;}
    .itemMeta{margin-top:4px; font-size:11px; color: rgba(168,179,199,.85); line-height:1.35;}
    .itemPrice{text-align:right; font-weight:900; white-space:nowrap;}
    .itemPrice .unit{display:block; font-size:11px; color: rgba(168,179,199,.85); font-weight:700; margin-top:2px;}

    .acc{
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      overflow:hidden;
      background: rgba(255,255,255,.03);
      margin:10px 0;
    }
    .accHead{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:10px 12px;
      cursor:pointer; user-select:none;
      background: rgba(255,255,255,.03);
    }
    .accTitleRow{display:flex; gap:10px; align-items:center;}
    .accTitle{font-weight:900; font-size:13px;}
    .accArrow{opacity:.8; transition:.15s transform;}
    .accBody{padding:10px 12px 12px; border-top:1px solid rgba(255,255,255,.08);}
    .acc.collapsed .accBody{display:none;}
    .acc.collapsed .accArrow{transform: rotate(-90deg);}

    .adminBar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:flex-start; justify-content:space-between;
      margin: 12px 0 0 0; padding:10px 12px;
      border:1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      background: rgba(255,255,255,.04);
    }
    .editGrid{display:grid; gap:8px; margin-top:8px;}
    .editText, .editNum{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:8px 10px;
      outline:none;
      font-size:13px;
    }
    .editNum{font-family:var(--mono);}
    .checkRow{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
    .chk{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.12);
      font-size:12px; color:var(--text);
      user-select:none;
    }
    .chk input{transform:scale(1.1)}

    @media (max-width: 980px){
      header{flex-direction:column; align-items:stretch}
      .topActions{justify-content:flex-start}
      .logoImg{width:min(340px, 100%)}
    }
    @media (max-width: 720px){
      .itemPrice{text-align:left; margin-top:6px;}
      .itemCard{grid-template-columns:1fr;}
    }

    @media print{
      header .topActions, .toolbar, .pill, .adminBar, .tabsWrap{display:none !important}
      body{background:#fff; color:#000}
      .panel{box-shadow:none; border:none}
      .card{break-inside:avoid; box-shadow:none; border:1px solid #ddd}
      .card::before{display:none}
      .wrap{max-width:none}
      .tiny{color:#444 !important}
      .badge{border-color:#bbb !important; color:#000 !important; background:#f5f5f5 !important}
      .logoImg{box-shadow:none !important; border-color:#ddd !important}
      .itemCard{border-color:#ddd !important; background:#fff !important}
      .thumb{border-color:#bbb !important}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <img class="logoImg" alt="Spectrum" src="logo.png" />
        <div>
          <div class="hTitle" id="brandTitle">‚Äî</div>
          <div class="subtitle" id="brandSub">‚Äî</div>
          <div class="subtitle" style="margin-top:8px">
            <span class="pill">üñ®Ô∏è Laser</span>
            <span class="pill">üìå Katalog Harga</span>
          </div>
        </div>
      </div>

      <div class="topActions">
        <span class="pill" id="todayPill">üìÖ</span>
        <a class="btn ok" id="btnWA" target="_blank" rel="noopener">üí¨ WhatsApp</a>
        <button class="btn primary" id="btnPrint">üñ®Ô∏è Print / Save PDF</button>

        <button class="btn" id="btnMode">üë§ Mode: Customer</button>
        <button class="btn" id="btnPass" title="Ganti password Admin">üîë Admin Password</button>

        <button class="btn" id="btnExport" title="Backup ke JSON">‚¨áÔ∏è Export JSON</button>
        <label class="btn" for="importFile" id="btnImportLabel" title="Import dari JSON">‚¨ÜÔ∏è Import JSON</label>
        <input id="importFile" type="file" accept="application/json" style="display:none" />
        <button class="btn danger" id="btnReset">‚Ü∫ Reset Default</button>
      </div>
    </header>

    <section class="panel">
      <div class="tabsWrap">
        <div class="tabs" id="tabs"></div>
        <div class="tiny" style="margin-top:8px;">Search global: ketik untuk browsing <span class="mono">semua produk</span> dari semua tab.</div>
      </div>

      <div class="toolbar">
        <div class="field">
          <label>Search global</label>
          <input id="q" class="input" placeholder="contoh: AP260, vinyl, brosur A5, kiss cut, laminasi, pvc..." />
        </div>
      </div>

      <div class="content">
        <div id="main"></div>
      </div>
    </section>
  </div>

  <script>
    (function(){
      const STORAGE_KEY = "spectrum_catalog_tabs_compact_v11_adminlock";
      const deepClone = (x)=>JSON.parse(JSON.stringify(x));

      const nf = new Intl.NumberFormat("id-ID");
      const rupiah = (n)=> "Rp " + nf.format(Number(n||0));
      const normalize = (s)=> (s||"").toString().toLowerCase().trim();

      const $ = (id)=>document.getElementById(id);

      function escapeHtml(str){
        return (str ?? "").toString()
          .replaceAll("&","&amp;")
          .replaceAll("<","&lt;")
          .replaceAll(">","&gt;")
          .replaceAll('"',"&quot;")
          .replaceAll("'","&#039;");
      }

      function thumbBoxHtml(title, img){
        if(img){
          return `<div class="thumb"><img src="${escapeHtml(img)}" alt=""></div>`;
        }
        return `<div class="thumb"><div class="ph">${escapeHtml(title || "IMG")}</div></div>`;
      }

      function badgeHtml(b){
        const cls = b?.style ? `badge ${b.style}` : "badge";
        return `<span class="${cls}">${escapeHtml(b?.text||"")}</span>`;
      }

      function accKey(sectionKey, groupTitle){ return `${sectionKey}::${groupTitle}`; }
      function isMobile(){ return window.matchMedia && window.matchMedia("(max-width: 720px)").matches; }

      // ===== Admin lock helpers =====
      function getAdminPass(){
        return (state?.settings?.adminPassword || "123123123spc").toString();
      }
      function isAdminUnlocked(){
        return localStorage.getItem(STORAGE_KEY + "_admin_unlocked") === "1";
      }
      function setAdminUnlocked(v){
        localStorage.setItem(STORAGE_KEY + "_admin_unlocked", v ? "1" : "0");
      }

      const DESC = {
        HVS: "Kertas HVS (uncoated) matte/halus. Cocok dokumen & materi belajar. Warna natural (tidak se-glossy art paper).",
        HVS_A3_ONLY: "Cetak hanya per A3 (1 lembar A3 muat 2 lembar A4). ",
        AP: "Art Paper (coated) halus, warna lebih tajam. Cocok flyer, poster, menu, dsb.",
        AP120: "Ringan untuk brosur/flyer ekonomis.",
        AP150: "Lebih tebal dari 120, masih fleksibel untuk brosur.",
        AP210: "Tebal, cocok cover ringan / kartu / booklet tipis (enak kalau dilaminasi).",
        AP260: "Tebal, umum untuk kartu/cover.",
        AP310: "Lebih kaku, cocok kartu & cover premium.",
        AP400: "Sangat tebal/kaku, cocok kartu premium/display kecil.",
        JASMINE: "Kertas tekstur premium (feel elegan). Cocok undangan/kartu.",
        COPEN: "Kertas tekstur premium, cocok undangan/kartu premium.",
        BLUSH: "Kertas tekstur premium, tone elegan. Cocok undangan/kartu.",
        BONTak: "Stiker kertas (tidak tahan air). Permukaan matte/halus. Cocok label indoor; bisa dilaminasi agar lebih awet.",
        VINYL_WHITE: "Stiker vinyl putih (tahan air). Cocok label produk/outdoor ringan.",
        VINYL_CLEAR: "Stiker vinyl transparan (tahan air). Cocok efek bening pada kaca/kemasan.",
        VINYL_METAL: "Stiker vinyl metalik (silver/gold) untuk efek premium, terlihat mengkilap.",
        GLORY: "Kertas foto glossy untuk warna lebih pop & mengkilap.",
        PVC: "ID Card bahan PVC (mirip kartu ATM). Harga 1 sisi dan bolak-balik sama."
      };

      const DEFAULT_STATE = {
        meta: {
          brandLine1: "Spectrum Digital Printing | Copy Center",
          brandLine2: "MULYOSARI",
          address: "Raya Mulyosari 95A",
          wa: "0895382392099",
          waE164: "62895382392099"
        },
        settings: {
          mode: "customer",
          adminPassword: "1234"   // ‚úÖ ganti password default di sini
        },
        ui: { activeTab: "fotocopy", accOpen: {} },
        sections: [
          { key:"fotocopy", title:"Fotocopy", headerThumb:true, thumbTitle:"Fotocopy", thumbImg:"",
            badge:{text:"Per sisi", style:"accent"}, sub:"Laser", type:"rows",
            rows:[
              {label:"A4 70 gram", price:300, unit:"sisi", desc:"Fotocopy standar untuk dokumen A4."},
              {label:"F4 70 gram", price:300, unit:"sisi", desc:"Fotocopy standar untuk ukuran F4/Folio."},
              {label:"A3 70 gram", price:600, unit:"sisi", desc:"Fotocopy ukuran besar A3."},
            ]
          },

          { key:"hitamputih", title:"Hitam Putih", headerThumb:true, thumbTitle:"BW", thumbImg:"",
            badge:{text:"Per sisi", style:"accent"}, sub:"Laser", type:"rows",
            rows:[
              {label:"A4 70 gram", price:500, unit:"sisi", desc:"Hemat untuk dokumen teks."},
              {label:"A4 80 gram", price:550, unit:"sisi", desc:"Lebih tebal & rapi."},
              {label:"F4 70 gram", price:500, unit:"sisi", desc:"Ukuran folio/F4."},
              {label:"A3 70 gram", price:800, unit:"sisi", desc:"Cetak BW ukuran besar A3."},
              {label:"A3 80 gram", price:1000, unit:"sisi", desc:"A3 lebih tebal."},
              {label:"A3+ 80 gram", price:1800, unit:"sisi", desc:"A3+ area cetak lebih luas."},
              {label:"A3+ 100 gram", price:1800, unit:"sisi", desc:"A3+ lebih tebal."},
            ]
          },

          { key:"warna", title:"Warna", headerThumb:true, thumbTitle:"Warna", thumbImg:"",
            badge:{text:"Per sisi", style:"accent"}, sub:"Laser", type:"groupedRows",
            groups: [
              { title:"HVS", headerThumb:true, rowThumb:false, thumbTitle:"HVS", thumbImg:"", rows:[
                {label:"HVS A3 70 gram", price:2700, unit:"sisi", desc: DESC.HVS_A3_ONLY + DESC.HVS },
                {label:"HVS A3 80 gram", price:2700, unit:"sisi", desc: DESC.HVS },
                {label:"HVS A3+ 80 gram", price:2700, unit:"sisi", desc: "Versi A3+ area cetak lebih luas. " + DESC.HVS },
                {label:"HVS A3+ 100 gram", price:2700, unit:"sisi", desc: "Lebih tebal. " + DESC.HVS },
              ]},

              { title:"Art Paper", headerThumb:true, rowThumb:false, thumbTitle:"Art Paper", thumbImg:"", rows:[
                {label:"AP120 gram", price:2700, unit:"sisi", desc: DESC.AP + " " + DESC.AP120},
                {label:"AP150 gram", price:2800, unit:"sisi", desc: DESC.AP + " " + DESC.AP150},
                {label:"AP210 gram", price:3100, unit:"sisi", desc: DESC.AP + " " + DESC.AP210},
                {label:"AP260 gram", price:3300, unit:"sisi", desc: DESC.AP + " " + DESC.AP260},
                {label:"AP310 gram", price:4000, unit:"sisi", desc: DESC.AP + " " + DESC.AP310},
                {label:"AP400 gram", price:7500, unit:"sisi", desc: DESC.AP + " " + DESC.AP400},
              ]},

              { title:"Kertas Tekstur", headerThumb:true, rowThumb:false, thumbTitle:"Tekstur", thumbImg:"", rows:[
                {label:"Jasmine 220 gram", price:4300, unit:"sisi", desc: DESC.JASMINE},
                {label:"Copenhagen 220 gram", price:4300, unit:"sisi", desc: DESC.COPEN},
                {label:"Blushwhite 270 gram", price:4300, unit:"sisi", desc: DESC.BLUSH},
              ]},

              { title:"Stiker", headerThumb:true, rowThumb:false, thumbTitle:"Stiker", thumbImg:"", rows:[
                {label:"Bontak (Tidak Anti Air)", price:4000, unit:"sisi", desc: DESC.BONTak},
                {label:"Vinyl Putih (Tahan Air)", price:8000, unit:"sisi", desc: DESC.VINYL_WHITE},
                {label:"Vinyl Transparan (Tahan Air)", price:8000, unit:"sisi", desc: DESC.VINYL_CLEAR},
                {label:"Vinyl Metalik (Silver/Gold)", price:12000, unit:"sisi", desc: DESC.VINYL_METAL},
              ]},

              { title:"ID Card PVC", headerThumb:true, rowThumb:false, thumbTitle:"PVC", thumbImg:"", rows:[
                {label:"ID Card PVC (Paket 2 pcs)", price:20000, unit:"paket", desc: DESC.PVC + " (Hitungan per 2 pcs)."},
                {label:"ID Card PVC (Paket 5 pcs)", price:37500, unit:"paket", desc: DESC.PVC + " (Hitungan per 5 pcs)."},
              ]},

              { title:"Lainnya", headerThumb:true, rowThumb:false, thumbTitle:"Lainnya", thumbImg:"", rows:[
                {label:"Glory A4", price:6000, unit:"sisi", desc: DESC.GLORY},
              ]},
            ]
          },

          { key:"kartunama", title:"Kartu Nama (1 box=100pcs ‚Ä¢ 9√ó5,5 cm)", headerThumb:true, thumbTitle:"Kartu Nama", thumbImg:"",
            badge:{text:"Per box", style:"blue"}, sub:"Laser", type:"rows2price",
            rows:[
              {label:"AP 260", p1:22000, p2:44000, desc:"Art Paper 260g, tebal untuk kartu."},
              {label:"AP 310", p1:27000, p2:54000, desc:"Art Paper 310g, lebih kaku/premium."},
              {label:"Blushwhite", p1:27000, p2:54000, desc:"Tekstur premium."},
              {label:"Copenhagen", p1:27000, p2:54000, desc:"Tekstur premium."},
              {label:"Jasmine", p1:27000, p2:54000, desc:"Tekstur premium."},
            ],
            extras:[
              {label:"Tambah Kotak", price:3000, unit:"pcs", desc:"Kotak kartu nama."},
              {label:"Laminasi (1 box) 1 sisi", price:16000, unit:"box", desc:"Laminasi doff/glossy 1 sisi."},
              {label:"Laminasi (1 box) 2 sisi", price:32000, unit:"box", desc:"Laminasi doff/glossy 2 sisi."},
            ]
          },

          { key:"brosur_1sisi", title:"Paket Brosur 1 Rim (1 sisi)", headerThumb:true, thumbTitle:"Brosur 1s", thumbImg:"",
            badge:{text:"Per rim", style:"ok"}, sub:"Laser", type:"rows",
            rows:[
              {label:"A6 ‚Ä¢ Artpaper 120", price:150000, unit:"rim", desc:"Brosur A6 ekonomis."},
              {label:"A6 ‚Ä¢ Artpaper 150", price:165000, unit:"rim", desc:"A6 lebih tebal."},
              {label:"A6 ‚Ä¢ HVS100", price:150000, unit:"rim", desc:"A6 HVS 100g."},
              {label:"A5 ‚Ä¢ Artpaper 120", price:265000, unit:"rim", desc:"A5 ekonomis."},
              {label:"A5 ‚Ä¢ Artpaper 150", price:280000, unit:"rim", desc:"A5 lebih tebal."},
              {label:"A5 ‚Ä¢ HVS100", price:265000, unit:"rim", desc:"A5 HVS 100g."},
              {label:"A4 ‚Ä¢ Artpaper 120", price:520000, unit:"rim", desc:"A4 ekonomis."},
              {label:"A4 ‚Ä¢ Artpaper 150", price:535000, unit:"rim", desc:"A4 lebih tebal."},
              {label:"A4 ‚Ä¢ HVS100", price:520000, unit:"rim", desc:"A4 HVS 100g."},
            ]
          },

          { key:"brosur_2sisi", title:"Paket Brosur 1 Rim (2 sisi)", headerThumb:true, thumbTitle:"Brosur 2s", thumbImg:"",
            badge:{text:"Per rim", style:"ok"}, sub:"Laser", type:"rows",
            rows:[
              {label:"A6 ‚Ä¢ Artpaper 120", price:265000, unit:"rim", desc:"A6 bolak-balik."},
              {label:"A6 ‚Ä¢ Artpaper 150", price:280000, unit:"rim", desc:"A6 lebih tebal."},
              {label:"A6 ‚Ä¢ HVS100", price:265000, unit:"rim", desc:"A6 HVS 100g."},
              {label:"A5 ‚Ä¢ Artpaper 120", price:535000, unit:"rim", desc:"A5 bolak-balik."},
              {label:"A5 ‚Ä¢ Artpaper 150", price:550000, unit:"rim", desc:"A5 lebih tebal."},
              {label:"A5 ‚Ä¢ HVS100", price:535000, unit:"rim", desc:"A5 HVS 100g."},
              {label:"A4 ‚Ä¢ Artpaper 120", price:950000, unit:"rim", desc:"A4 bolak-balik."},
              {label:"A4 ‚Ä¢ Artpaper 150", price:1000000, unit:"rim", desc:"A4 lebih tebal."},
              {label:"A4 ‚Ä¢ HVS100", price:950000, unit:"rim", desc:"A4 HVS 100g."},
            ]
          },

          { key:"laminasi_a3", title:"Laminasi", headerThumb:true, thumbTitle:"Laminasi", thumbImg:"",
            badge:{text:"Add-on", style:"blue"}, sub:"Per sisi ‚Ä¢ Laser", type:"rows",
            rows:[
              {label:"Laminasi A3 (Glossy/Doff)", price:4000, unit:"sisi",
               desc:"Hanya untuk Art Paper ¬± AP210 ke atas & bahan stiker. Glossy mengkilap, doff matte/elegan."}
            ]
          },

          { key:"laminating", title:"Laminating", headerThumb:true, thumbTitle:"Laminating", thumbImg:"",
            badge:{text:"Add-on", style:"blue"}, sub:"Laser", type:"rows",
            rows:[
              {label:"Laminating F4", price:5000, unit:"lembar", desc:"Laminating ukuran F4."},
              {label:"Laminating A3", price:10000, unit:"lembar", desc:"Laminating ukuran A3."},
            ]
          },

          { key:"cutting", title:"Jasa Cutting (per lembar A3)", headerThumb:true, thumbTitle:"Cutting", thumbImg:"",
            badge:{text:"Add-on", style:"blue"}, sub:"Maks 3 desain/gambar per lembar", type:"groupedRows",
            groups:[
              { title:"Kiss Cut (setengah putus)", headerThumb:true, rowThumb:false, thumbTitle:"Kiss Cut", thumbImg:"", rows:[
                {label:"S ‚Ä¢ 1 ‚Äì 45 pcs", price:4500, unit:"lembar", desc:"Kiss cut: potong stiker saja, backing tetap utuh."},
                {label:"M ‚Ä¢ 46 ‚Äì 90 pcs", price:7500, unit:"lembar", desc:"Kiss cut ukuran M."},
                {label:"L ‚Ä¢ 91 ‚Äì 135 pcs", price:12000, unit:"lembar", desc:"Kiss cut ukuran L."},
                {label:"XL ‚Ä¢ 136 ‚Äì 200 pcs", price:20000, unit:"lembar", desc:"Kiss cut ukuran XL."},
                {label:"XXL ‚Ä¢ 201 ‚Äì 300 pcs", price:35000, unit:"lembar", desc:"Kiss cut ukuran XXL."},
                {label:"3XL ‚Ä¢ 301 ‚Äì 500 pcs", price:50000, unit:"lembar", desc:"Kiss cut ukuran 3XL."},
                {label:"4XL ‚Ä¢ 501 ‚Äì 1000 pcs", price:100000, unit:"lembar", desc:"Kiss cut ukuran 4XL."},
              ]},
              { title:"Die Cut (cutting putus)", headerThumb:true, rowThumb:false, thumbTitle:"Die Cut", thumbImg:"", rows:[
                {label:"S ‚Ä¢ 1 ‚Äì 45 pcs", price:5000, unit:"lembar", desc:"Die cut: potong sampai putus termasuk backing."},
                {label:"M ‚Ä¢ 46 ‚Äì 90 pcs", price:10000, unit:"lembar", desc:"Die cut ukuran M."},
                {label:"L ‚Ä¢ 91 ‚Äì 135 pcs", price:15000, unit:"lembar", desc:"Die cut ukuran L."},
                {label:"XL ‚Ä¢ 136 ‚Äì 200 pcs", price:25000, unit:"lembar", desc:"Die cut ukuran XL."},
                {label:"XXL ‚Ä¢ 201 ‚Äì 300 pcs", price:35000, unit:"lembar", desc:"Die cut ukuran XXL."},
              ]},
            ]
          },

          { key:"jilid", title:"Macam-macam Jilid", headerThumb:true, thumbTitle:"Jilid", thumbImg:"",
            badge:{text:"Info", style:"blue"}, sub:"Harga menyesuaikan ketebalan/jumlah halaman", type:"textRows",
            rows:[
              {label:"Spiral", text:"Rp 6.000 ‚Äì 28.000", desc:"Cocok untuk notes/buku kerja (bisa dibuka 360¬∞)."},
              {label:"Lakban", text:"Rp 4.000 ‚Äì 15.000", desc:"Jilid cepat & rapi, kuat sesuai tebal."},
              {label:"Mika", text:"Rp 1.000 / lembar", desc:"Cover transparan (depan/back)."},
              {label:"Bufalo", text:"Rp 1.000 / lembar", desc:"Cover doff/tekstur lebih kokoh."},
              {label:"Softcover", text:"Rp 20.500 ‚Äì 50.000", desc:"Cover fleksibel seperti buku, harga sesuai tebal."},
              {label:"Hardcover", text:"Rp 35.000", desc:"Cover keras premium."},
            ]
          },
        ]
      };

      const TAB_ORDER = [
        {key:"fotocopy", title:"Fotocopy"},
        {key:"hitamputih", title:"Hitam Putih"},
        {key:"warna", title:"Warna"},
        {key:"kartunama", title:"Kartu Nama"},
        {key:"brosur_1sisi", title:"Brosur 1 sisi"},
        {key:"brosur_2sisi", title:"Brosur 2 sisi"},
        {key:"laminasi_a3", title:"Laminasi"},
        {key:"laminating", title:"Laminating"},
        {key:"cutting", title:"Cutting"},
        {key:"jilid", title:"Jilid"},
      ];

      function loadState(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          if(!raw) return deepClone(DEFAULT_STATE);
          const obj = JSON.parse(raw);
          if(!obj?.sections) return deepClone(DEFAULT_STATE);
          if(!obj.ui) obj.ui = {activeTab:"fotocopy", accOpen:{}};
          if(!obj.ui.accOpen) obj.ui.accOpen = {};
          if(!obj.settings) obj.settings = deepClone(DEFAULT_STATE.settings);
          if(!obj.settings.adminPassword) obj.settings.adminPassword = DEFAULT_STATE.settings.adminPassword;
          return obj;
        }catch(e){
          return deepClone(DEFAULT_STATE);
        }
      }
      function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

      let state = loadState();
      let isAdmin = false;

      function applyMode(mode){
        // Jika admin belum unlock, paksa customer
        if(mode === "admin" && !isAdminUnlocked()){
          mode = "customer";
        }
        state.settings.mode = mode;
        isAdmin = (mode === "admin");

        $("btnMode").textContent = isAdmin ? "üõ†Ô∏è Mode: Admin" : "üë§ Mode: Customer";
        $("btnExport").style.display = isAdmin ? "" : "none";
        $("btnImportLabel").style.display = isAdmin ? "" : "none";
        $("btnReset").style.display = isAdmin ? "" : "none";
        $("btnPass").style.display = isAdmin ? "" : "none";

        saveState();
      }

      function initBrand(){
        const m = state.meta;
        $("brandTitle").textContent = m.brandLine1;
        $("brandSub").innerHTML =
          `<b>${escapeHtml(m.brandLine2)}</b><br>` +
          `üìç ${escapeHtml(m.address)}<br>` +
          `üì± WA: <span class="mono">${escapeHtml(m.wa)}</span>`;
        $("btnWA").href = `https://wa.me/${m.waE164}`;
        $("btnWA").textContent = `üí¨ WA ${m.wa}`;

        const d = new Date();
        const fmt = new Intl.DateTimeFormat("id-ID", { weekday:"long", year:"numeric", month:"long", day:"numeric" });
        $("todayPill").textContent = "üìÖ " + fmt.format(d);
      }

      function renderTabs(){
        const tabs = $("tabs");
        tabs.innerHTML = "";
        TAB_ORDER.forEach(t=>{
          const el = document.createElement("div");
          el.className = "tab" + (t.key===state.ui.activeTab ? " active" : "");
          el.textContent = t.title;
          el.onclick = ()=>{
            state.ui.activeTab = t.key;
            saveState();
            renderTabs();
            render();
          };
          tabs.appendChild(el);
        });
      }

      window.toggleAcc = function(key){
        state.ui.accOpen = state.ui.accOpen || {};
        state.ui.accOpen[key] = !state.ui.accOpen[key];
        saveState();
        render();
      };

      function sectionHeaderHtml(section){
        const hasThumb = !!section.headerThumb;
        return `
          <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin:4px 0 10px 0;">
            <div style="display:flex; gap:10px; align-items:center;">
              ${hasThumb ? thumbBoxHtml(section.thumbTitle || section.title, section.thumbImg || "") : ""}
              <div>
                <div style="font-weight:900; font-size:14px;">${escapeHtml(section.title)}</div>
                <div class="tiny">${escapeHtml(section.sub||"")}</div>
              </div>
            </div>
            ${section.badge ? badgeHtml(section.badge) : ""}
          </div>
        `;
      }

      function adminSectionThumbEditor(section){
        if(!isAdmin) return "";
        return `
          <div class="adminBar">
            <div style="flex:1; min-width:260px;">
              <div class="tiny"><b>Thumbnail Judul Tab</b> (opsional)</div>
              <div class="checkRow" style="margin-top:8px;">
                <label class="chk">
                  <input type="checkbox" data-edit data-skey="${section.key}" data-type="sectionHeader" data-field="headerThumb"
                         ${section.headerThumb ? "checked":""}>
                  Tampilkan thumbnail judul
                </label>
              </div>
              <div class="editGrid">
                <input class="editText" data-edit data-skey="${section.key}" data-type="sectionHeader" data-field="thumbTitle"
                  placeholder="Teks fallback (misal: HVS, AP, Laminasi)" value="${escapeHtml(section.thumbTitle||"")}">
                <input class="editText" data-edit data-skey="${section.key}" data-type="sectionHeader" data-field="thumbImg"
                  placeholder="URL gambar thumbnail judul (contoh: https://.../gambar.png)" value="${escapeHtml(section.thumbImg||"")}">
              </div>
              <div class="tiny" style="margin-top:6px;">Tip: kalau URL kosong, thumbnail akan pakai teks.</div>
            </div>
          </div>
        `;
      }

      function adminGroupThumbEditor(sectionKey, g, gidx){
        if(!isAdmin) return "";
        return `
          <div class="adminBar" style="margin:0 0 10px 0;">
            <div style="flex:1; min-width:260px;">
              <div class="tiny"><b>Thumbnail Judul Sub-Kategori</b> (opsional)</div>
              <div class="checkRow" style="margin-top:8px;">
                <label class="chk">
                  <input type="checkbox" data-edit data-skey="${sectionKey}" data-type="groupHeader" data-gidx="${gidx}" data-field="headerThumb"
                         ${g.headerThumb ? "checked":""}>
                  Tampilkan thumbnail di judul sub-kategori
                </label>
              </div>
              <div class="editGrid">
                <input class="editText" data-edit data-skey="${sectionKey}" data-type="groupHeader" data-gidx="${gidx}" data-field="thumbTitle"
                  placeholder="Teks fallback (misal: HVS, Stiker, Kiss Cut)" value="${escapeHtml(g.thumbTitle||"")}">
                <input class="editText" data-edit data-skey="${sectionKey}" data-type="groupHeader" data-gidx="${gidx}" data-field="thumbImg"
                  placeholder="URL gambar thumbnail sub-kategori (https://...)" value="${escapeHtml(g.thumbImg||"")}">
              </div>
            </div>
          </div>
        `;
      }

      function bindAdminEditors(){
        if(!isAdmin) return;

        document.querySelectorAll("[data-edit]").forEach(inp=>{
          inp.addEventListener("input", ()=>{
            const skey = inp.dataset.skey;
            const section = state.sections.find(x=>x.key===skey);
            if(!section) return;

            const t = inp.dataset.type;
            const field = inp.dataset.field;
            const value = (inp.type === "checkbox") ? inp.checked : inp.value;

            if(t === "sectionHeader"){
              section[field] = (inp.type === "checkbox") ? !!value : value;
              saveState(); render(); return;
            }

            if(t === "groupHeader"){
              const gidx = +inp.dataset.gidx;
              const g = section.groups?.[gidx];
              if(!g) return;
              g[field] = (inp.type === "checkbox") ? !!value : value;
              saveState(); render(); return;
            }

            if(t === "rows"){
              const idx = +inp.dataset.idx;
              if(field === "price") section.rows[idx][field] = Number(value||0);
              else section.rows[idx][field] = value;
              saveState(); return;
            }

            if(t === "groupedRows"){
              const gidx = +inp.dataset.gidx;
              const ridx = +inp.dataset.ridx;
              if(field === "price") section.groups[gidx].rows[ridx][field] = Number(value||0);
              else section.groups[gidx].rows[ridx][field] = value;
              saveState(); return;
            }

            if(t === "rows2price"){
              const idx = +inp.dataset.idx;
              if(field === "p1" || field === "p2") section.rows[idx][field] = Number(value||0);
              else section.rows[idx][field] = value;
              saveState(); return;
            }

            if(t === "extras"){
              const idx = +inp.dataset.idx;
              if(field === "price") section.extras[idx][field] = Number(value||0);
              else section.extras[idx][field] = value;
              saveState(); return;
            }

            if(t === "textRows"){
              const idx = +inp.dataset.idx;
              section.rows[idx][field] = value;
              saveState(); return;
            }
          }, {passive:true});
        });
      }

      function render(){
        const q = normalize($("q").value);
        const main = $("main");
        main.innerHTML = "";

        const match = (obj)=> !q || normalize(JSON.stringify(obj)).includes(q);

        const renderRows = (section, rows) => {
          let html = `<div class="itemList">`;
          rows.forEach((r, idx)=>{
            html += `
              <div class="itemCard">
                <div class="itemMain">
                  <div class="itemName">${escapeHtml(r.label)}</div>
                  <div class="itemMeta">${escapeHtml(r.desc||"")}</div>

                  ${isAdmin ? `
                    <div class="editGrid">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="rows" data-idx="${idx}" data-field="label"
                        value="${escapeHtml(r.label)}">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="rows" data-idx="${idx}" data-field="desc"
                        placeholder="Deskripsi (opsional)" value="${escapeHtml(r.desc||"")}">
                      <div style="display:flex; gap:8px; align-items:center;">
                        <input class="editNum" data-edit style="max-width:170px" type="number" min="0" step="50"
                          data-skey="${section.key}" data-type="rows" data-idx="${idx}" data-field="price"
                          value="${Number(r.price)||0}">
                        <span class="tiny">/ <input class="editText" data-edit style="max-width:120px"
                          data-skey="${section.key}" data-type="rows" data-idx="${idx}" data-field="unit"
                          value="${escapeHtml(r.unit||"")}"></span>
                      </div>
                    </div>
                  `:``}
                </div>
                <div class="itemPrice">
                  ${rupiah(r.price)}
                  <span class="unit">/ ${escapeHtml(r.unit||"")}</span>
                </div>
              </div>
            `;
          });
          html += `</div>`;
          return html;
        };

        const renderTextRows = (section, rows) => {
          let html = `<div class="itemList">`;
          rows.forEach((r, idx)=>{
            html += `
              <div class="itemCard">
                <div class="itemMain">
                  <div class="itemName">${escapeHtml(r.label)}</div>
                  <div class="itemMeta">${escapeHtml(r.desc || r.text || "")}</div>

                  ${isAdmin ? `
                    <div class="editGrid">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="textRows" data-idx="${idx}" data-field="label"
                        value="${escapeHtml(r.label)}">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="textRows" data-idx="${idx}" data-field="text"
                        value="${escapeHtml(r.text||"")}">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="textRows" data-idx="${idx}" data-field="desc"
                        placeholder="Deskripsi (opsional)" value="${escapeHtml(r.desc||"")}">
                    </div>
                  `:``}
                </div>
                <div class="itemPrice"><span class="unit">${escapeHtml(r.text||"")}</span></div>
              </div>
            `;
          });
          html += `</div>`;
          return html;
        };

        const renderGrouped = (section, groups) => {
          state.ui.accOpen = state.ui.accOpen || {};
          let html = "";
          groups.forEach((g, gidx)=>{
            const k = accKey(section.key, g.title);
            if(state.ui.accOpen[k] === undefined) state.ui.accOpen[k] = !isMobile();
            const collapsed = !state.ui.accOpen[k];

            const showHeaderThumb = !!g.headerThumb;
            const rowsFiltered = (g.rows||[]).filter(match);
            if(q && !rowsFiltered.length) return;

            html += `
              <div class="acc ${collapsed ? "collapsed":""}">
                <div class="accHead" onclick="toggleAcc('${escapeHtml(k)}')">
                  <div class="accTitleRow">
                    ${showHeaderThumb ? thumbBoxHtml(g.thumbTitle || g.title, g.thumbImg || "") : ""}
                    <div class="accTitle">${escapeHtml(g.title)}</div>
                  </div>
                  <div class="accArrow">‚ñæ</div>
                </div>
                <div class="accBody">
                  ${adminGroupThumbEditor(section.key, g, gidx)}
                  <div class="itemList">
            `;

            (q ? rowsFiltered : (g.rows||[])).forEach((r, ridx)=>{
              html += `
                <div class="itemCard">
                  <div class="itemMain">
                    <div class="itemName">${escapeHtml(r.label)}</div>
                    <div class="itemMeta">${escapeHtml(r.desc || g.title)}</div>

                    ${isAdmin ? `
                      <div class="editGrid">
                        <input class="editText" data-edit data-skey="${section.key}" data-type="groupedRows" data-gidx="${gidx}" data-ridx="${ridx}" data-field="label"
                          value="${escapeHtml(r.label)}">
                        <input class="editText" data-edit data-skey="${section.key}" data-type="groupedRows" data-gidx="${gidx}" data-ridx="${ridx}" data-field="desc"
                          placeholder="Deskripsi (opsional)" value="${escapeHtml(r.desc||"")}">
                        <div style="display:flex; gap:8px; align-items:center;">
                          <input class="editNum" data-edit style="max-width:170px" type="number" min="0" step="50"
                            data-skey="${section.key}" data-type="groupedRows" data-gidx="${gidx}" data-ridx="${ridx}" data-field="price"
                            value="${Number(r.price)||0}">
                          <span class="tiny">/ <input class="editText" data-edit style="max-width:120px"
                            data-skey="${section.key}" data-type="groupedRows" data-gidx="${gidx}" data-ridx="${ridx}" data-field="unit"
                            value="${escapeHtml(r.unit||"")}"></span>
                        </div>
                      </div>
                    `:``}
                  </div>
                  <div class="itemPrice">
                    ${rupiah(r.price)}
                    <span class="unit">/ ${escapeHtml(r.unit||"")}</span>
                  </div>
                </div>
              `;
            });

            html += `</div></div></div>`;
          });

          return html || `<div class="tiny">Tidak ada data.</div>`;
        };

        const renderRows2price = (section) => {
          let html = `<div class="itemList">`;
          (section.rows||[]).forEach((r, idx)=>{
            if(q && !match(r)) return;
            html += `
              <div class="itemCard">
                <div class="itemMain">
                  <div class="itemName">${escapeHtml(r.label)}</div>
                  <div class="itemMeta">${escapeHtml(r.desc||"")}</div>

                  ${isAdmin ? `
                    <div class="editGrid">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="rows2price" data-idx="${idx}" data-field="label" value="${escapeHtml(r.label)}">
                      <input class="editText" data-edit data-skey="${section.key}" data-type="rows2price" data-idx="${idx}" data-field="desc" placeholder="Deskripsi" value="${escapeHtml(r.desc||"")}">
                      <div style="display:flex; gap:8px;">
                        <input class="editNum" data-edit data-skey="${section.key}" data-type="rows2price" data-idx="${idx}" data-field="p1" type="number" min="0" step="500" value="${Number(r.p1)||0}">
                        <input class="editNum" data-edit data-skey="${section.key}" data-type="rows2price" data-idx="${idx}" data-field="p2" type="number" min="0" step="500" value="${Number(r.p2)||0}">
                      </div>
                    </div>
                  `:``}
                </div>
                <div class="itemPrice">
                  ${rupiah(r.p1)} ‚Ä¢ ${rupiah(r.p2)}
                  <span class="unit">/ box</span>
                </div>
              </div>
            `;
          });
          html += `</div>`;

          if(section.extras?.length){
            html += `<div class="tiny" style="margin:10px 0 6px 0;"><b>Tambahan</b></div>`;
            html += `<div class="itemList">`;
            section.extras.forEach((ex, exi)=>{
              if(q && !match(ex)) return;
              html += `
                <div class="itemCard">
                  <div class="itemMain">
                    <div class="itemName">${escapeHtml(ex.label)}</div>
                    <div class="itemMeta">${escapeHtml(ex.desc||"")}</div>

                    ${isAdmin ? `
                      <div class="editGrid">
                        <input class="editText" data-edit data-skey="${section.key}" data-type="extras" data-idx="${exi}" data-field="label" value="${escapeHtml(ex.label)}">
                        <input class="editText" data-edit data-skey="${section.key}" data-type="extras" data-idx="${exi}" data-field="desc" placeholder="Deskripsi" value="${escapeHtml(ex.desc||"")}">
                        <div style="display:flex; gap:8px; align-items:center;">
                          <input class="editNum" data-edit style="max-width:170px" type="number" min="0" step="500"
                            data-skey="${section.key}" data-type="extras" data-idx="${exi}" data-field="price"
                            value="${Number(ex.price)||0}">
                          <span class="tiny">/ <input class="editText" data-edit style="max-width:120px"
                            data-skey="${section.key}" data-type="extras" data-idx="${exi}" data-field="unit"
                            value="${escapeHtml(ex.unit||"")}"></span>
                        </div>
                      </div>
                    `:``}
                  </div>
                  <div class="itemPrice">
                    ${rupiah(ex.price)}
                    <span class="unit">/ ${escapeHtml(ex.unit||"")}</span>
                  </div>
                </div>
              `;
            });
            html += `</div>`;
          }

          return html;
        };

        // ===== GLOBAL SEARCH =====
        if(q){
          const card = document.createElement("div");
          card.className = "card";

          let html = `
            <div class="cardInner">
              <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin:4px 0 10px 0;">
                <div>
                  <div style="font-weight:900; font-size:14px;">Hasil Search</div>
                  <div class="tiny">Menampilkan hasil dari semua tab untuk: <span class="mono">${escapeHtml(q)}</span></div>
                </div>
                <span class="badge accent">Global</span>
              </div>
          `;

          let found = false;

          state.sections.forEach(section=>{
            if(section.type === "rows"){
              const rows = (section.rows||[]).filter(match);
              if(!rows.length) return;
              found = true;
              html += sectionHeaderHtml(section);
              html += renderRows(section, rows);
              html += `<div style="height:10px"></div>`;
            }

            if(section.type === "groupedRows"){
              const tmp = renderGrouped(section, section.groups||[]);
              if(tmp.includes("Tidak ada data")) return;
              found = true;
              html += sectionHeaderHtml(section);
              html += tmp;
              html += `<div style="height:10px"></div>`;
            }

            if(section.type === "rows2price"){
              const any = (section.rows||[]).some(match) || (section.extras||[]).some(match);
              if(!any) return;
              found = true;
              html += sectionHeaderHtml(section);
              html += renderRows2price(section);
              html += `<div style="height:10px"></div>`;
            }

            if(section.type === "textRows"){
              const rows = (section.rows||[]).filter(match);
              if(!rows.length) return;
              found = true;
              html += sectionHeaderHtml(section);
              html += renderTextRows(section, rows);
              html += `<div style="height:10px"></div>`;
            }
          });

          if(!found) html += `<div class="tiny">Tidak ada hasil yang cocok.</div>`;
          html += `</div>`;
          card.innerHTML = html;
          main.appendChild(card);
          return;
        }

        // ===== NORMAL TAB MODE =====
        const section = state.sections.find(x=>x.key===state.ui.activeTab) || state.sections[0];
        if(!section) return;

        const card = document.createElement("div");
        card.className = "card";

        let body = sectionHeaderHtml(section);
        body += adminSectionThumbEditor(section);

        if(section.type === "rows"){
          body += renderRows(section, section.rows||[]);
        } else if(section.type === "groupedRows"){
          body += renderGrouped(section, section.groups||[]);
        } else if(section.type === "rows2price"){
          body += renderRows2price(section);
        } else if(section.type === "textRows"){
          body += renderTextRows(section, section.rows||[]);
        }

        card.innerHTML = `<div class="cardInner">${body}</div>`;
        main.appendChild(card);

        bindAdminEditors();
      }

      function wireUI(){
        // ‚úÖ Mode + password lock
        $("btnMode").onclick = ()=>{
          if(isAdmin){
            // keluar admin -> kunci lagi
            setAdminUnlocked(false);
            applyMode("customer");
            render();
            return;
          }

          // mau masuk admin: minta password
          const pass = prompt("Masukkan password Admin:");
          if(pass === null) return;

          if(pass.toString() === getAdminPass()){
            setAdminUnlocked(true);
            applyMode("admin");
            render();
          }else{
            alert("Password salah.");
          }
        };

        // ‚úÖ ganti password (hanya muncul saat admin)
        $("btnPass").onclick = ()=>{
          const np = prompt("Password Admin baru (min 4 karakter):");
          if(np === null) return;
          const val = (np||"").toString();
          if(val.length < 4){
            alert("Minimal 4 karakter.");
            return;
          }
          state.settings.adminPassword = val;
          saveState();
          alert("Password berhasil diganti ‚úÖ");
        };

        $("btnPrint").onclick = ()=>window.print();

        $("btnExport").onclick = ()=>{
          const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "spectrum-katalog-harga.json";
          document.body.appendChild(a);
          a.click();
          a.remove();
          setTimeout(()=>URL.revokeObjectURL(a.href), 600);
        };

        $("importFile").onchange = (ev)=>{
          const file = ev.target.files?.[0];
          if(!file) return;
          const reader = new FileReader();
          reader.onload = ()=>{
            try{
              const obj = JSON.parse(reader.result);
              if(!obj?.sections) throw new Error("Format tidak sesuai");
              state = obj;
              if(!state.ui) state.ui = {activeTab:"fotocopy", accOpen:{}};
              if(!state.ui.accOpen) state.ui.accOpen = {};
              if(!state.settings) state.settings = deepClone(DEFAULT_STATE.settings);
              if(!state.settings.adminPassword) state.settings.adminPassword = DEFAULT_STATE.settings.adminPassword;

              // demi keamanan: setelah import, admin tetap terkunci sampai unlock lagi
              setAdminUnlocked(false);
              applyMode("customer");

              saveState();
              initBrand();
              renderTabs();
              render();
              alert("Import berhasil ‚úÖ (Admin terkunci, unlock lagi kalau mau edit)");
            }catch(e){
              alert("Gagal import JSON. Pastikan file benar.");
            }
          };
          reader.readAsText(file);
          ev.target.value = "";
        };

        $("btnReset").onclick = ()=>{
          if(confirm("Reset ke default? (data edit akan hilang)")){
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem(STORAGE_KEY + "_admin_unlocked");
            state = deepClone(DEFAULT_STATE);
            applyMode("customer");
            initBrand();
            renderTabs();
            render();
          }
        };

        $("q").oninput = render;
      }

      // START
      try{
        // selalu mulai customer, admin wajib unlock via password
        setAdminUnlocked(false);
        applyMode("customer");

        initBrand();
        renderTabs();
        wireUI();
        render();
      }catch(err){
        console.error(err);
        alert("Ada error pada script. Cek Console (F12) atau kirim screenshot errornya.");
      }
    })();
  </script>
</body>
</html>

